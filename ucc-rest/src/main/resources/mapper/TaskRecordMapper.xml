<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.cucsi.bsd.ucc.common.mapper.TaskRecordMapper" >
  <resultMap id="BaseResultMap" type="cn.cucsi.bsd.ucc.data.domain.TaskRecord" >
		<result column="TASK_RECORD_ID" property="taskRecordId" jdbcType="VARCHAR" />
		<result column="TARIFF_NAME" property="tariffName" jdbcType="VARCHAR" />
		<result column="IMPORT_BATCH" property="importBatch" jdbcType="VARCHAR" />
		<result column="IMPORT_TIME" property="importTime" jdbcType="TIMESTAMP" />
		<result column="IMPORT_PERSON_ID" property="importPersonId" jdbcType="VARCHAR" />
		<result column="BUSINESS_CODE" property="businessCode" jdbcType="VARCHAR" />
		<result column="TASK_TYPE_NAME" property="taskTypeName" jdbcType="VARCHAR" />
		<result column="DEPT_MESH_ID" property="deptMeshId" jdbcType="VARCHAR" />
		<result column="DEPT_AREA_ID" property="deptAreaId" jdbcType="VARCHAR" />
		<result column="PRODUCT_TYPE" property="productType" jdbcType="VARCHAR" />
		<result column="PHONE_NUMBER1" property="phoneNumber1" jdbcType="VARCHAR" />
		<result column="PHONE_NUMBER2" property="phoneNumber2" jdbcType="VARCHAR" />
		<result column="PHONE_NUMBER" property="phoneNumber" jdbcType="VARCHAR" />
		<result column="VELOCITY" property="velocity" jdbcType="VARCHAR" />
		<result column="CUSTOMFIELDS1" property="customfields1" jdbcType="VARCHAR" />
		<result column="CUSTOMFIELDS2" property="customfields2" jdbcType="VARCHAR" />
		<result column="CUSTOMFIELDS3" property="customfields3" jdbcType="VARCHAR" />
		<result column="CUSTOMFIELDS4" property="customfields4" jdbcType="VARCHAR" />
		<result column="CUSTOMFIELDS5" property="customfields5" jdbcType="VARCHAR" />
		<result column="CUSTOMFIELDS6" property="customfields6" jdbcType="VARCHAR" />
		<result column="CUSTOMFIELDS7" property="customfields7" jdbcType="VARCHAR" />
		<result column="CUSTOMFIELDS8" property="customfields8" jdbcType="VARCHAR" />
		<result column="CUSTOMFIELDS9" property="customfields9" jdbcType="VARCHAR" />
		<result column="CUSTOMFIELDS10" property="customfields10" jdbcType="VARCHAR" />
		<result column="CUSTOMFIELDS11" property="customfields11" jdbcType="VARCHAR" />
		<result column="CUSTOMFIELDS12" property="customfields12" jdbcType="VARCHAR" />
		<result column="CUSTOMFIELDS13" property="customfields13" jdbcType="VARCHAR" />
		<result column="CUSTOMFIELDS14" property="customfields14" jdbcType="VARCHAR" />
		<result column="CUSTOMFIELDS15" property="customfields15" jdbcType="VARCHAR" />
		<result column="RESPONSIBLE" property="responsible" jdbcType="VARCHAR" />
		<result column="NET_STOP" property="netStop" jdbcType="VARCHAR" />
		<result column="PACKAGE_NAME" property="packageName" jdbcType="VARCHAR" />
		<result column="CONTRACT_NAME" property="contractName" jdbcType="VARCHAR" />
		<result column="CONTRACT_START_TIME" property="contractStartTime" jdbcType="VARCHAR" />
		<result column="CONTRACT_END_TIME" property="contractEndTime" jdbcType="VARCHAR" />
		<result column="ACTIVATION_TIME" property="activationTime" jdbcType="VARCHAR" />
		<result column="DEVELOPMENT_ID" property="developmentId" jdbcType="VARCHAR" />
		<result column="CONTACTS" property="contacts" jdbcType="VARCHAR" />
		<result column="USER_NAME" property="userName" jdbcType="VARCHAR" />
		<result column="INSTALLED_ADDRESS" property="installedAddress" jdbcType="VARCHAR" />
		<result column="STATUS" property="status" jdbcType="VARCHAR" />
		<result column="PON_LOGO" property="ponLogo" jdbcType="VARCHAR" />
		<result column="CDR_ID" property="cdrId" jdbcType="VARCHAR" />
		<result column="RECORD_TIME" property="recordTime" jdbcType="TIMESTAMP" />
		<result column="OPERATOR_ID" property="operatorId" jdbcType="VARCHAR" />
		<result column="OPERATOR_DEPT" property="operatorDept" jdbcType="VARCHAR" />
		<result column="CALL_MEMO" property="callMemo" jdbcType="VARCHAR" />
		<result column="CALL_RESULT" property="callResult" jdbcType="VARCHAR" />
		<result column="CALL_RESULT_NAME" property="callResultName" jdbcType="VARCHAR" />
		<result column="DEPT_MESH_NAME" property="deptMeshName" jdbcType="VARCHAR" />
		<result column="DEPT_AREA_NAME" property="deptAreaName" jdbcType="VARCHAR" />
		<result column="DEVELOPMENT_DEPT_NAME" property="developmentDeptName" jdbcType="VARCHAR" />
		<result column="TASK_TYPE_ID" property="taskTypeId" jdbcType="VARCHAR" />
		<result column="TASK_CODE" property="taskCode" jdbcType="VARCHAR" />
		<result column="INIT_DEVELOPMENT" property="initDevelopment" jdbcType="VARCHAR" />
		<result column="INIT_MESH_ID" property="initMeshId" jdbcType="VARCHAR" />
		<result column="INIT_AREA_ID" property="initAreaId" jdbcType="VARCHAR" />
		<result column="NICK_NAME" property="nickName" jdbcType="VARCHAR" />
		<result column="TRANSFER_TIME" property="transferTime" jdbcType="TIMESTAMP" />
		<result column="OPERATOR_DEPT_NAME" property="operatorDName" jdbcType="VARCHAR" />
		<result column="import_Person_Name" property="importPersonName" jdbcType="VARCHAR" />
		<result column="operator_Name" property="operatorName" jdbcType="VARCHAR" />
		<result column="DEFULT_PHONE" property="defultPhone" jdbcType="VARCHAR" />
		<result column="RATE" property="rate" jdbcType="VARCHAR" />
		<result column="TOTAL_TIME" property="totalTime" jdbcType="VARCHAR" />
		<result column="HANGUP_CAUSE" property="hangupCause" jdbcType="VARCHAR" />
		<result column="END_DATE" property="endDate" jdbcType="TIMESTAMP" />
	  	<result column="domain_id" property="domainId" jdbcType="VARCHAR" />
  </resultMap>

	<sql id="Base_Column_List">
		TASK_RECORD_ID, TARIFF_NAME, IMPORT_BATCH,
		IMPORT_TIME, IMPORT_PERSON_ID, BUSINESS_CODE,
		TASK_TYPE_NAME, DEPT_MESH_ID, DEPT_AREA_ID,
		PRODUCT_TYPE, PHONE_NUMBER1, PHONE_NUMBER2,
		PHONE_NUMBER, VELOCITY, CUSTOMFIELDS1,
		CUSTOMFIELDS2, CUSTOMFIELDS3, CUSTOMFIELDS4,
		CUSTOMFIELDS5, CUSTOMFIELDS6, CUSTOMFIELDS7,
		CUSTOMFIELDS8, CUSTOMFIELDS9, CUSTOMFIELDS10,
		CUSTOMFIELDS11, CUSTOMFIELDS12, CUSTOMFIELDS13,
		CUSTOMFIELDS14, CUSTOMFIELDS15, RESPONSIBLE,
		NET_STOP, PACKAGE_NAME, CONTRACT_NAME,
		CONTRACT_START_TIME, CONTRACT_END_TIME, ACTIVATION_TIME,
		DEVELOPMENT_ID, CONTACTS, USER_NAME,
		INSTALLED_ADDRESS, STATUS, PON_LOGO,
		CDR_ID, RECORD_TIME, OPERATOR_ID,
		OPERATOR_DEPT, CALL_MEMO, CALL_RESULT,
		TASK_TYPE_ID, TASK_CODE, INIT_DEVELOPMENT,
		INIT_MESH_ID, INIT_AREA_ID,dict.dict_key CALL_RESULT_NAME,END_DATE,domain_id
	</sql>

	<sql id="Sql_From">
		from OC_TASK_RECORD a left join base_dict dict on dict.dict_type='callResultType' and a.CALL_RESULT = dict.dict_key
	</sql>
	<!-- 分页查询 -->

	<sql id="Sql_Where">
		<if test="businessCode != null and businessCode != ''">
			and a.BUSINESS_CODE = #{businessCode}
		</if>
		<if test="taskTypeId != null and taskTypeId != ''">
			and a.TASK_TYPE_ID = #{taskTypeId}
		</if>
		<if test="importBatch != null and importBatch != ''">
			and a.import_batch = #{importBatch}
		</if>
		<if test="deptMeshName != null and deptMeshName != ''">
			and p1.dept_name LIKE '%${deptMeshName}%'
		</if>
		<if test=" domainId != null and domainId != ''">
			and a.domain_id = #{domainId}
		</if>
		<if test="deptAreaName != null and deptAreaName != ''">
			and p2.dept_name LIKE '%${deptAreaName}%'
		</if>
		<if test="developmentDeptName != null and developmentDeptName != ''">
			and p3.dept_name LIKE '%${developmentDeptName}%'
		</if>
		<if test="null!=startTime and startTime != ''">
			and DATE_FORMAT(a.IMPORT_TIME,'%Y-%m-%d %H:%i:%S') &gt;= #{startTime}
		</if>
		<if test=" null!=endTime and endTime != ''">
			and DATE_FORMAT(a.IMPORT_TIME,'%Y-%m-%d %H:%i:%S') &lt;= #{endTime}
		</if>
		<if test=" callResult != null and callResult != ''">
			and r.CALL_RESULT = #{callResult}
		</if>
	</sql>

	<insert id="insert" parameterType="cn.cucsi.bsd.ucc.data.domain.TaskRecord">
		insert into OC_TASK_RECORD (TASK_RECORD_ID, TARIFF_NAME, IMPORT_BATCH,
		IMPORT_TIME, IMPORT_PERSON_ID, BUSINESS_CODE,
		TASK_TYPE_NAME, DEPT_MESH_ID, DEPT_AREA_ID,
		PRODUCT_TYPE, PHONE_NUMBER1, PHONE_NUMBER2,
		PHONE_NUMBER, VELOCITY, CUSTOMFIELDS1,
		CUSTOMFIELDS2, CUSTOMFIELDS3, CUSTOMFIELDS4,
		CUSTOMFIELDS5, CUSTOMFIELDS6, CUSTOMFIELDS7,
		CUSTOMFIELDS8, CUSTOMFIELDS9, CUSTOMFIELDS10,
		CUSTOMFIELDS11, CUSTOMFIELDS12, CUSTOMFIELDS13,
		CUSTOMFIELDS14, CUSTOMFIELDS15, RESPONSIBLE,
		NET_STOP, PACKAGE_NAME, CONTRACT_NAME,
		CONTRACT_START_TIME, CONTRACT_END_TIME, ACTIVATION_TIME,
		DEVELOPMENT_ID, CONTACTS, USER_NAME,
		INSTALLED_ADDRESS, STATUS, PON_LOGO,
		CDR_ID, RECORD_TIME, OPERATOR_ID,
		OPERATOR_DEPT, CALL_MEMO, CALL_RESULT,
		TASK_TYPE_ID, TASK_CODE, INIT_DEVELOPMENT,
		INIT_MESH_ID, INIT_AREA_ID, END_DATE,domain_id
		)
		values (#{taskRecordId,jdbcType=VARCHAR}, #{tariffName,jdbcType=VARCHAR},
		#{importBatch,jdbcType=VARCHAR},
		#{importTime,jdbcType=TIMESTAMP}, #{importPersonId,jdbcType=VARCHAR}, #{businessCode,jdbcType=VARCHAR},
		#{taskTypeName,jdbcType=VARCHAR}, #{deptMeshId,jdbcType=VARCHAR},
		#{deptAreaId,jdbcType=VARCHAR},
		#{productType,jdbcType=VARCHAR}, #{phoneNumber1,jdbcType=VARCHAR}, #{phoneNumber2,jdbcType=VARCHAR},
		#{phoneNumber,jdbcType=VARCHAR}, #{velocity,jdbcType=VARCHAR},
		#{customfields1,jdbcType=VARCHAR},
		#{customfields2,jdbcType=VARCHAR}, #{customfields3,jdbcType=VARCHAR}, #{customfields4,jdbcType=VARCHAR},
		#{customfields5,jdbcType=VARCHAR}, #{customfields6,jdbcType=VARCHAR},
		#{customfields7,jdbcType=VARCHAR},
		#{customfields8,jdbcType=VARCHAR}, #{customfields9,jdbcType=VARCHAR},
		#{customfields10,jdbcType=VARCHAR},
		#{customfields11,jdbcType=VARCHAR},
		#{customfields12,jdbcType=VARCHAR},
		#{customfields13,jdbcType=VARCHAR},
		#{customfields14,jdbcType=VARCHAR},
		#{customfields15,jdbcType=VARCHAR}, #{responsible,jdbcType=VARCHAR},
		#{netStop,jdbcType=VARCHAR}, #{packageName,jdbcType=VARCHAR},
		#{contractName,jdbcType=VARCHAR},
		#{contractStartTime,jdbcType=VARCHAR},
		#{contractEndTime,jdbcType=VARCHAR},
		#{activationTime,jdbcType=VARCHAR},
		#{developmentId,jdbcType=VARCHAR}, #{contacts,jdbcType=VARCHAR}, #{userName,jdbcType=VARCHAR},
		#{installedAddress,jdbcType=VARCHAR}, #{status,jdbcType=VARCHAR},
		#{ponLogo,jdbcType=VARCHAR},
		#{cdrId,jdbcType=VARCHAR}, #{recordTime,jdbcType=TIMESTAMP}, #{operatorId,jdbcType=VARCHAR},
		#{operatorDept,jdbcType=VARCHAR}, #{callMemo,jdbcType=VARCHAR},
		#{callResult,jdbcType=VARCHAR},
		#{taskTypeId,jdbcType=VARCHAR}, #{taskCode,jdbcType=VARCHAR}, #{initDevelopment,jdbcType=VARCHAR},
		#{initMeshId,jdbcType=VARCHAR}, #{initAreaId,jdbcType=VARCHAR}, #{endDate,jdbcType=TIMESTAMP},
		#{domainId,jdbcType=VARCHAR}
		)
	</insert>
	<insert id="insertSelective" parameterType="cn.cucsi.bsd.ucc.data.domain.TaskRecord">
		insert into OC_TASK_RECORD
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="taskRecordId != null">
				TASK_RECORD_ID,
			</if>
			<if test="tariffName != null">
				TARIFF_NAME,
			</if>
			<if test="importBatch != null">
				IMPORT_BATCH,
			</if>
			<if test="importTime != null">
				IMPORT_TIME,
			</if>
			<if test="importPersonId != null">
				IMPORT_PERSON_ID,
			</if>
			<if test="businessCode != null">
				BUSINESS_CODE,
			</if>
			<if test="taskTypeName != null">
				TASK_TYPE_NAME,
			</if>
			<if test="deptMeshId != null">
				DEPT_MESH_ID,
			</if>
			<if test="deptAreaId != null">
				DEPT_AREA_ID,
			</if>
			<if test="productType != null">
				PRODUCT_TYPE,
			</if>
			<if test="phoneNumber1 != null">
				PHONE_NUMBER1,
			</if>
			<if test="phoneNumber2 != null">
				PHONE_NUMBER2,
			</if>
			<if test="phoneNumber != null">
				PHONE_NUMBER,
			</if>
			<if test="velocity != null">
				VELOCITY,
			</if>
			<if test="customfields1 != null">
				CUSTOMFIELDS1,
			</if>
			<if test="customfields2 != null">
				CUSTOMFIELDS2,
			</if>
			<if test="customfields3 != null">
				CUSTOMFIELDS3,
			</if>
			<if test="customfields4 != null">
				CUSTOMFIELDS4,
			</if>
			<if test="customfields5 != null">
				CUSTOMFIELDS5,
			</if>
			<if test="customfields6 != null">
				CUSTOMFIELDS6,
			</if>
			<if test="customfields7 != null">
				CUSTOMFIELDS7,
			</if>
			<if test="customfields8 != null">
				CUSTOMFIELDS8,
			</if>
			<if test="customfields9 != null">
				CUSTOMFIELDS9,
			</if>
			<if test="customfields10 != null">
				CUSTOMFIELDS10,
			</if>
			<if test="customfields11 != null">
				CUSTOMFIELDS11,
			</if>
			<if test="customfields12 != null">
				CUSTOMFIELDS12,
			</if>
			<if test="customfields13 != null">
				CUSTOMFIELDS13,
			</if>
			<if test="customfields14 != null">
				CUSTOMFIELDS14,
			</if>
			<if test="customfields15 != null">
				CUSTOMFIELDS15,
			</if>
			<if test="responsible != null">
				RESPONSIBLE,
			</if>
			<if test="netStop != null">
				NET_STOP,
			</if>
			<if test="packageName != null">
				PACKAGE_NAME,
			</if>
			<if test="contractName != null">
				CONTRACT_NAME,
			</if>
			<if test="contractStartTime != null">
				CONTRACT_START_TIME,
			</if>
			<if test="contractEndTime != null">
				CONTRACT_END_TIME,
			</if>
			<if test="activationTime != null">
				ACTIVATION_TIME,
			</if>
			<if test="developmentId != null">
				DEVELOPMENT_ID,
			</if>
			<if test="contacts != null">
				CONTACTS,
			</if>
			<if test="userName != null">
				USER_NAME,
			</if>
			<if test="installedAddress != null">
				INSTALLED_ADDRESS,
			</if>
			<if test="status != null">
				STATUS,
			</if>
			<if test="ponLogo != null">
				PON_LOGO,
			</if>
			<if test="cdrId != null">
				CDR_ID,
			</if>
			<if test="recordTime != null">
				RECORD_TIME,
			</if>
			<if test="operatorId != null">
				OPERATOR_ID,
			</if>
			<if test="operatorDept != null">
				OPERATOR_DEPT,
			</if>
			<if test="callMemo != null">
				CALL_MEMO,
			</if>
			<if test="callResult != null">
				CALL_RESULT,
			</if>
			<if test="endDate != null">
				END_DATE,
			</if>
			<if test="domainId != null" >
				domain_id,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="taskRecordId != null">
				#{taskRecordId,jdbcType=VARCHAR},
			</if>
			<if test="tariffName != null">
				#{tariffName,jdbcType=VARCHAR},
			</if>
			<if test="importBatch != null">
				#{importBatch,jdbcType=VARCHAR},
			</if>
			<if test="importTime != null">
				#{importTime,jdbcType=TIMESTAMP},
			</if>
			<if test="importPersonId != null">
				#{importPersonId,jdbcType=VARCHAR},
			</if>
			<if test="businessCode != null">
				#{businessCode,jdbcType=VARCHAR},
			</if>
			<if test="taskTypeName != null">
				#{taskTypeName,jdbcType=VARCHAR},
			</if>
			<if test="deptMeshId != null">
				#{deptMeshId,jdbcType=VARCHAR},
			</if>
			<if test="deptAreaId != null">
				#{deptAreaId,jdbcType=VARCHAR},
			</if>
			<if test="productType != null">
				#{productType,jdbcType=VARCHAR},
			</if>
			<if test="phoneNumber1 != null">
				#{phoneNumber1,jdbcType=VARCHAR},
			</if>
			<if test="phoneNumber2 != null">
				#{phoneNumber2,jdbcType=VARCHAR},
			</if>
			<if test="phoneNumber != null">
				#{phoneNumber,jdbcType=VARCHAR},
			</if>
			<if test="velocity != null">
				#{velocity,jdbcType=VARCHAR},
			</if>
			<if test="customfields1 != null">
				#{customfields1,jdbcType=VARCHAR},
			</if>
			<if test="customfields2 != null">
				#{customfields2,jdbcType=VARCHAR},
			</if>
			<if test="customfields3 != null">
				#{customfields3,jdbcType=VARCHAR},
			</if>
			<if test="customfields4 != null">
				#{customfields4,jdbcType=VARCHAR},
			</if>
			<if test="customfields5 != null">
				#{customfields5,jdbcType=VARCHAR},
			</if>
			<if test="customfields6 != null">
				#{customfields6,jdbcType=VARCHAR},
			</if>
			<if test="customfields7 != null">
				#{customfields7,jdbcType=VARCHAR},
			</if>
			<if test="customfields8 != null">
				#{customfields8,jdbcType=VARCHAR},
			</if>
			<if test="customfields9 != null">
				#{customfields9,jdbcType=VARCHAR},
			</if>
			<if test="customfields10 != null">
				#{customfields10,jdbcType=VARCHAR},
			</if>
			<if test="customfields11 != null">
				#{customfields11,jdbcType=VARCHAR},
			</if>
			<if test="customfields12 != null">
				#{customfields12,jdbcType=VARCHAR},
			</if>
			<if test="customfields13 != null">
				#{customfields13,jdbcType=VARCHAR},
			</if>
			<if test="customfields14 != null">
				#{customfields14,jdbcType=VARCHAR},
			</if>
			<if test="customfields15 != null">
				#{customfields15,jdbcType=VARCHAR},
			</if>
			<if test="responsible != null">
				#{responsible,jdbcType=VARCHAR},
			</if>
			<if test="netStop != null">
				#{netStop,jdbcType=VARCHAR},
			</if>
			<if test="packageName != null">
				#{packageName,jdbcType=VARCHAR},
			</if>
			<if test="contractName != null">
				#{contractName,jdbcType=VARCHAR},
			</if>
			<if test="contractStartTime != null">
				#{contractStartTime,jdbcType=VARCHAR},
			</if>
			<if test="contractEndTime != null">
				#{contractEndTime,jdbcType=VARCHAR},
			</if>
			<if test="activationTime != null">
				#{activationTime,jdbcType=VARCHAR},
			</if>
			<if test="developmentId != null">
				#{developmentId,jdbcType=VARCHAR},
			</if>
			<if test="contacts != null">
				#{contacts,jdbcType=VARCHAR},
			</if>
			<if test="userName != null">
				#{userName,jdbcType=VARCHAR},
			</if>
			<if test="installedAddress != null">
				#{installedAddress,jdbcType=VARCHAR},
			</if>
			<if test="status != null">
				#{status,jdbcType=VARCHAR},
			</if>
			<if test="ponLogo != null">
				#{ponLogo,jdbcType=VARCHAR},
			</if>
			<if test="cdrId != null">
				#{cdrId,jdbcType=VARCHAR},
			</if>
			<if test="recordTime != null">
				#{recordTime,jdbcType=TIMESTAMP},
			</if>
			<if test="operatorId != null">
				#{operatorId,jdbcType=VARCHAR},
			</if>
			<if test="operatorDept != null">
				#{operatorDept,jdbcType=VARCHAR},
			</if>
			<if test="callMemo != null">
				#{callMemo,jdbcType=VARCHAR},
			</if>
			<if test="callResult != null">
				#{callResult,jdbcType=VARCHAR},
			</if>
			<if test="endDate != null">
				#{endDate,jdbcType=TIMESTAMP},
			</if>
			<if test="domainId != null" >
				#{domainId,jdbcType=VARCHAR},
			</if>
		</trim>
	</insert>

	<select id="selectAll" resultMap="BaseResultMap"
		parameterType="cn.cucsi.bsd.ucc.common.beans.TaskRecordSearch">
		select
			a.TASK_RECORD_ID, a.TARIFF_NAME, a.IMPORT_BATCH,
			a.IMPORT_TIME, a.IMPORT_PERSON_ID, a.BUSINESS_CODE,
			a.DEPT_MESH_ID, a.DEPT_AREA_ID,
			a.PRODUCT_TYPE, a.PHONE_NUMBER1, a.PHONE_NUMBER2,
			a.PHONE_NUMBER, a.VELOCITY, a.CUSTOMFIELDS1,
			a.CUSTOMFIELDS2, a.CUSTOMFIELDS3, a.CUSTOMFIELDS4,
			a.CUSTOMFIELDS5, a.CUSTOMFIELDS6, a.CUSTOMFIELDS7,
			a.CUSTOMFIELDS8, a.CUSTOMFIELDS9, a.CUSTOMFIELDS10,
			a.CUSTOMFIELDS11, a.CUSTOMFIELDS12, a.CUSTOMFIELDS13,
			a.CUSTOMFIELDS14, a.CUSTOMFIELDS15, a.RESPONSIBLE,
			a.NET_STOP, a.PACKAGE_NAME, a.CONTRACT_NAME,
			a.CONTRACT_START_TIME, a.CONTRACT_END_TIME, a.ACTIVATION_TIME,
			a.DEVELOPMENT_ID, a.CONTACTS,
			a.INSTALLED_ADDRESS, a.STATUS, a.PON_LOGO,
			a.CDR_ID, a.RECORD_TIME, a.OPERATOR_ID,
			a.OPERATOR_DEPT, a.CALL_MEMO, a.CALL_RESULT,
			a.TASK_TYPE_ID, a.TASK_CODE, a.INIT_DEVELOPMENT,
			a.INIT_MESH_ID, a.INIT_AREA_ID, a.domain_id,
			p1.dept_name as DEPT_MESH_NAME, p2.dept_name as DEPT_AREA_NAME,
			p3.dept_name as DEVELOPMENT_DEPT_NAME,
			p4.dept_name as OPERATOR_DEPT_NAME ,
			cus.cust_name as USER_NAME,
			u1.user_name as import_Person_Name,
			u2.user_name as operator_Name ,
			u2.NICK_NAME as NICK_NAME,
			t1.TASK_TYPE_Name as TASK_TYPE_NAME,
			a.TASK_CODE,
			c.total_time as TOTAL_TIME,
			c.hangup_cause as HANGUP_CAUSE,
			cus.DEFULT_PHONE as DEFULT_PHONE,
			dict.dict_value as CALL_RESULT_NAME,
			r.TRANSFER_TIME as TRANSFER_TIME,
			a.END_DATE
		from OC_TASK_RECORD a
		left join ucc_depts p1 on a.DEPT_MESH_ID = p1.dept_id
		left join ucc_depts p2 on a.DEPT_AREA_ID = p2.dept_id
		left join ucc_depts p3 on a.DEVELOPMENT_ID = p3.dept_id
		left join ucc_depts p4 on a.OPERATOR_DEPT = p4.dept_id
		left join ucc_customers cus on a.BUSINESS_CODE = cus.businesscode and a.domain_id = cus.domain_id
		left join ucc_users u1 on a.import_Person_ID = u1.user_id
		left join ucc_users u2 on a.operator_ID = u2.user_id
		left join OC_TASK_TYPE t1 on t1.TASK_TYPE_ID = a.TASK_TYPE_ID
		left join OC_TASK_TRANSFER_RECORD r ON a.TASK_RECORD_ID = r.TASK_RECORD_ID AND r.TRANSFER_STATUS = '4'
		left join pbx_cdrs c on r.CDR_ID = c.cdr_id
		left join base_dict dict on a.CALL_RESULT = dict.dict_key and dict.dict_type = 'callResultType'
		where 1=1
		<include refid="Sql_Where" />
		order by a.record_Time desc
		<if test="begin != null and showLines != null and showLines !=0">
			limit #{begin},#{showLines}
		</if>
	</select>
	
	<select id="selectAllCount" resultType="int"
		parameterType="cn.cucsi.bsd.ucc.common.beans.TaskRecordSearch">
		select
		count(a.TASK_RECORD_ID)
		from OC_TASK_RECORD a
		left join ucc_depts p1 on a.DEPT_MESH_ID = p1.dept_id
		left join ucc_depts p2 on a.DEPT_AREA_ID = p2.dept_id
		left join ucc_depts p3 on a.DEVELOPMENT_ID = p3.dept_id
		left join ucc_depts p4 on a.OPERATOR_DEPT = p4.dept_id
		left join ucc_customers cus on a.BUSINESS_CODE = cus.businesscode and a.domain_id = cus.domain_id
		left join ucc_users u1 on a.import_Person_ID = u1.user_id
		left join ucc_users u2 on a.operator_ID = u2.user_id
		left join OC_TASK_TYPE t1 on t1.TASK_TYPE_ID = a.TASK_TYPE_ID
		left join OC_TASK_TRANSFER_RECORD r ON a.TASK_RECORD_ID = r.TASK_RECORD_ID AND r.TRANSFER_STATUS = '4'
		left join pbx_cdrs c on r.CDR_ID = c.cdr_id
		left join base_dict dict on a.CALL_RESULT = dict.dict_key and dict.dict_type = 'callResultType'
		where 1=1
		<include refid="Sql_Where" />
	</select>

	<select id="selectById" resultMap="BaseResultMap"
		parameterType="java.lang.String">
		select
		a.TASK_RECORD_ID,  a.IMPORT_BATCH,
		a.IMPORT_TIME, a.IMPORT_PERSON_ID, a.BUSINESS_CODE,
		a.DEPT_MESH_ID, a.DEPT_AREA_ID,
		a.PHONE_NUMBER1, a.PHONE_NUMBER2,
		a.PHONE_NUMBER, a.VELOCITY, a.CUSTOMFIELDS1,
		a.CUSTOMFIELDS2, a.CUSTOMFIELDS3, a.CUSTOMFIELDS4,
		a.CUSTOMFIELDS5, a.CUSTOMFIELDS6, a.CUSTOMFIELDS7,
		a.CUSTOMFIELDS8, a.CUSTOMFIELDS9, a.CUSTOMFIELDS10,
		a.CUSTOMFIELDS11, a.CUSTOMFIELDS12, a.CUSTOMFIELDS13,
		a.CUSTOMFIELDS14, a.CUSTOMFIELDS15, a.RESPONSIBLE,
		a.NET_STOP, a.PACKAGE_NAME, a.CONTRACT_NAME,
		a.CONTRACT_START_TIME, a.CONTRACT_END_TIME, a.ACTIVATION_TIME,
		a.DEVELOPMENT_ID,
		a.CDR_ID, a.RECORD_TIME, a.OPERATOR_ID,
		a.OPERATOR_DEPT, a.CALL_MEMO, a.CALL_RESULT,
		a.TASK_TYPE_ID, a.TASK_CODE, a.INIT_DEVELOPMENT,
		a.INIT_MESH_ID, a.INIT_AREA_ID,
		c.DEFULT_PHONE DEFULT_PHONE,
		c.cust_name USER_NAME,
		c.contacts CONTACTS,
		c.status STATUS,
		c.installedaddress INSTALLED_ADDRESS,
		c.ponlogo PON_LOGO,
		c.tariffname TARIFF_NAME,
		c.PRODUCT_TYPE PRODUCT_TYPE,
		c.RATE RATE
		, p1.dept_name DEPT_MESH_NAME, p2.dept_name DEPT_AREA_NAME,
		p3.dept_name DEVELOPMENT_DEPT_NAME,
		a.END_DATE
		<include refid="Sql_From"></include>
		left join ucc_depts p1 on a.DEPT_MESH_ID = p1.dept_id
		left join ucc_depts p2 on a.DEPT_AREA_ID = p2.dept_id
		left join ucc_depts p3 on a.DEVELOPMENT_ID = p3.dept_id
		left join ucc_customers c on c.businesscode = a.BUSINESS_CODE and a.domain_id = c.domain_id
		where
		a.TASK_RECORD_ID = #{taskRecordId}
		order by a.record_Time desc
	</select>

	<select id="selectBySearchCount" resultType="int"
		parameterType="cn.cucsi.bsd.ucc.common.beans.TaskRecordSearch">
		SELECT
			count(d.TASK_RECORD_ID)
		FROM
			OC_TASK_RECORD d
			LEFT JOIN ucc_customers c ON d.BUSINESS_CODE = c.businesscode
			LEFT JOIN OC_TASK_TRANSFER_RECORD r ON d.TASK_RECORD_ID = r.TASK_RECORD_ID
			AND r.TRANSFER_STATUS = '4'
			LEFT JOIN ucc_users u ON u.user_id = r.OPERATOR_ID
			LEFT JOIN ucc_depts p ON p.dept_id = r.OPERATOR_DEPT
			LEFT JOIN OC_TASK_TYPE e ON e.TASK_TYPE_ID = d.TASK_TYPE_ID
			LEFT JOIN ucc_depts p1 ON d.DEPT_MESH_ID = p1.dept_id
			LEFT JOIN ucc_depts p2 ON d.DEPT_AREA_ID = p2.dept_id
		WHERE
			1 = 1
		<if test="null!=startTime and startTime != ''">
			and DATE_FORMAT(TRANSFER_TIME,'%Y-%m-%d') &gt;= #{startTime}
		</if>
		<if test=" null!=endTime and endTime != ''">
			and DATE_FORMAT(TRANSFER_TIME,'%Y-%m-%d') &lt;= #{endTime}
		</if>
		<if test=" callResult != null and callResult != ''">
			and r.CALL_RESULT = #{callResult}
		</if>
		<include refid="Sql_MonitorWhere" />
	</select>

	<delete id="deleteByTime" parameterType="java.lang.String">
		delete
		from OC_TASK_RECORD
		where DATE_FORMAT(RECORD_TIME,'%Y-%m-%d') &lt; #{recordTime}
	</delete>
	
	<!-- 按时间删除归档流转表 -->
	<delete id="deleteTaskRecordTransferByTime" parameterType="java.lang.String">
		delete
		from OC_TASK_TRANSFER_RECORD
		where DATE_FORMAT(RECORD_TIME,'%Y-%m-%d') &lt; #{recordTime}
	</delete>
	
    <!-- 批量插入 -->
	<insert id="insertGroup" parameterType="map">
	  insert into OC_TASK_RECORD (TASK_RECORD_ID, TARIFF_NAME, IMPORT_BATCH, 
      IMPORT_TIME, IMPORT_PERSON_ID, BUSINESS_CODE, 
      TASK_TYPE_NAME, DEPT_MESH_ID, DEPT_AREA_ID, 
      PRODUCT_TYPE, PHONE_NUMBER1, PHONE_NUMBER2, 
      PHONE_NUMBER, VELOCITY, CUSTOMFIELDS1, 
      CUSTOMFIELDS2, CUSTOMFIELDS3, CUSTOMFIELDS4, 
      CUSTOMFIELDS5, CUSTOMFIELDS6, CUSTOMFIELDS7, 
      CUSTOMFIELDS8, CUSTOMFIELDS9, CUSTOMFIELDS10, 
      CUSTOMFIELDS11, CUSTOMFIELDS12, CUSTOMFIELDS13, 
      CUSTOMFIELDS14, CUSTOMFIELDS15, RESPONSIBLE, 
      NET_STOP, PACKAGE_NAME, CONTRACT_NAME, 
      CONTRACT_START_TIME, CONTRACT_END_TIME, ACTIVATION_TIME, 
      DEVELOPMENT_ID, CONTACTS, USER_NAME, 
      INSTALLED_ADDRESS, STATUS, PON_LOGO, 
      CDR_ID, RECORD_TIME, OPERATOR_ID, 
      OPERATOR_DEPT, CALL_MEMO, CALL_RESULT, 
      TASK_TYPE_ID, TASK_CODE, INIT_DEVELOPMENT, 
      INIT_MESH_ID, INIT_AREA_ID, END_DATE,domain_id)
	   values 
		<foreach collection="list" item="record" index="index" separator=",">
		(#{record.taskRecordId,jdbcType=VARCHAR}, #{record.tariffName,jdbcType=VARCHAR}, #{record.importBatch,jdbcType=VARCHAR}, 
      #{record.importTime,jdbcType=TIMESTAMP}, #{record.importPersonId,jdbcType=VARCHAR}, #{record.businessCode,jdbcType=VARCHAR}, 
      #{record.taskTypeName,jdbcType=VARCHAR}, #{record.deptMeshId,jdbcType=VARCHAR}, #{record.deptAreaId,jdbcType=VARCHAR}, 
      #{record.productType,jdbcType=VARCHAR}, #{record.phoneNumber1,jdbcType=VARCHAR}, #{record.phoneNumber2,jdbcType=VARCHAR}, 
      #{record.phoneNumber,jdbcType=VARCHAR}, #{record.velocity,jdbcType=VARCHAR}, #{record.customfields1,jdbcType=VARCHAR}, 
      #{record.customfields2,jdbcType=VARCHAR}, #{record.customfields3,jdbcType=VARCHAR}, #{record.customfields4,jdbcType=VARCHAR}, 
      #{record.customfields5,jdbcType=VARCHAR}, #{record.customfields6,jdbcType=VARCHAR}, #{record.customfields7,jdbcType=VARCHAR}, 
      #{record.customfields8,jdbcType=VARCHAR}, #{record.customfields9,jdbcType=VARCHAR}, #{record.customfields10,jdbcType=VARCHAR}, 
      #{record.customfields11,jdbcType=VARCHAR}, #{record.customfields12,jdbcType=VARCHAR}, #{record.customfields13,jdbcType=VARCHAR}, 
      #{record.customfields14,jdbcType=VARCHAR}, #{record.customfields15,jdbcType=VARCHAR}, #{record.responsible,jdbcType=VARCHAR}, 
      #{record.netStop,jdbcType=VARCHAR}, #{record.packageName,jdbcType=VARCHAR}, #{record.contractName,jdbcType=VARCHAR}, 
      #{record.contractStartTime,jdbcType=VARCHAR}, #{record.contractEndTime,jdbcType=VARCHAR}, #{record.activationTime,jdbcType=VARCHAR}, 
      #{record.developmentId,jdbcType=VARCHAR}, #{record.contacts,jdbcType=VARCHAR}, #{record.userName,jdbcType=VARCHAR}, 
      #{record.installedAddress,jdbcType=VARCHAR}, #{record.status,jdbcType=VARCHAR}, #{record.ponLogo,jdbcType=VARCHAR}, 
      #{record.cdrId,jdbcType=VARCHAR}, #{record.recordTime,jdbcType=TIMESTAMP}, #{record.operatorId,jdbcType=VARCHAR}, 
      #{record.operatorDept,jdbcType=VARCHAR}, #{record.callMemo,jdbcType=VARCHAR}, #{record.callResult,jdbcType=VARCHAR}, 
      #{record.taskTypeId,jdbcType=VARCHAR}, #{record.taskCode,jdbcType=VARCHAR}, #{record.initDevelopment,jdbcType=VARCHAR}, 
      #{record.initMeshId,jdbcType=VARCHAR}, #{record.initAreaId,jdbcType=VARCHAR}, #{record.endDate,jdbcType=TIMESTAMP}, #{record.domainId,jdbcType=VARCHAR})
		</foreach>
	</insert>

	<select id="selectBySearch" resultMap="BaseResultMap"
		parameterType="cn.cucsi.bsd.ucc.common.beans.TaskRecordSearch">
		SELECT
			d.TASK_CODE TASK_CODE,
			e.TASK_TYPE_NAME TASK_TYPE_NAME,
			d.BUSINESS_CODE BUSINESS_CODE,
			c.cust_name USER_NAME,
			c.DEFULT_PHONE DEFULT_PHONE,
			u.nick_name nick_name,
			p.dept_name OPERATOR_DEPT_NAME,
			r.TRANSFER_TIME TRANSFER_TIME,
			d.TASK_RECORD_ID TASK_RECORD_ID,
			r.CALL_RESULT CALL_RESULT
		FROM
			OC_TASK_RECORD d
			LEFT JOIN ucc_customers c ON d.BUSINESS_CODE = c.businesscode
			LEFT JOIN OC_TASK_TRANSFER_RECORD r ON d.TASK_RECORD_ID = r.TASK_RECORD_ID
			AND r.TRANSFER_STATUS = '4'
			LEFT JOIN ucc_users u ON u.user_id = r.OPERATOR_ID
			LEFT JOIN ucc_depts p ON p.dept_id = r.OPERATOR_DEPT
			LEFT JOIN OC_TASK_TYPE e ON e.TASK_TYPE_ID = d.TASK_TYPE_ID
			LEFT JOIN ucc_depts p1 ON d.DEPT_MESH_ID = p1.dept_id
			LEFT JOIN ucc_depts p2 ON d.DEPT_AREA_ID = p2.dept_id
		WHERE
			1 = 1
		<if test="null!=startTime and startTime != ''">
			and DATE_FORMAT(TRANSFER_TIME,'%Y-%m-%d') &gt;= #{startTime}
		</if>
		<if test=" null!=endTime and endTime != ''">
			and DATE_FORMAT(TRANSFER_TIME,'%Y-%m-%d') &lt;= #{endTime}
		</if>
		<if test=" callResult != null and callResult != ''">
			and r.CALL_RESULT = #{callResult}
		</if>
		
		<include refid="Sql_MonitorWhere" />
		order by d.TASK_CODE DESC
		<if test="begin != null and showLines != null and showLines != 0">
			limit #{begin},#{showLines}
		</if>
	</select>

	<!-- 任务监控列表 -->
	<sql id="Sql_MonitorWhere">
		<if test="businessCode != null and businessCode != ''">
			and d.BUSINESS_CODE = #{businessCode}
		</if>
		<if test="taskTypeName != null and taskTypeName != ''">
			and d.TASK_TYPE_ID = #{taskTypeName}
		</if>
		<if test="deptMeshName != null and deptMeshName != ''">
			and p1.dept_name LIKE '%${deptMeshName}%'
		</if>
		<if test="deptAreaName != null and deptAreaName != ''">
			and p2.dept_name LIKE '%${deptAreaName}%'
		</if>
		<if test="developmentDeptName != null and developmentDeptName != ''">
			and p3.dept_name LIKE '%${developmentDeptName}%'
		</if>
		<if test="taskTypeId != null and taskTypeId != ''">
			and d.TASK_TYPE_ID = #{taskTypeId}
		</if>
		<if test="taskCode != null and taskCode != ''">
			and d.TASK_CODE  LIKE '%${taskCode}%'
		</if>
		<if test="userName != null and userName != ''">
			and c.cust_name LIKE '%${userName}%'
		</if>
		<if test="phoneNumber != null and phoneNumber != ''">
			and c.DEFULT_PHONE LIKE '%${phoneNumber}%'
		</if>
	</sql>

</mapper>